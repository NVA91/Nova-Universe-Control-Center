---
name: "üè• Daily Health Check"

on:
  schedule:
    - cron: '0 2 * * *'
  workflow_dispatch:

jobs:
  health-check:
    name: "üîç Check Service Health"
    runs-on: [self-hosted, proxmox]
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      - name: "Install Tools"
        run: pip install ansible
      - name: "Docker Services"
        run: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
      - name: "Semaphore Health"
        run: curl -sf http://localhost:3000/api/ping && echo "‚úÖ Semaphore OK" || echo "‚ö†Ô∏è Semaphore DOWN"
      - name: "Traefik Health"
        run: curl -sf -k https://localhost:8080/ping && echo "‚úÖ Traefik OK" || echo "‚ö†Ô∏è Traefik DOWN"
      - name: "Disk Space"
        run: df -h /
